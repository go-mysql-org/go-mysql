package replication

import (
	"fmt"

	. "gopkg.in/check.v1"
)

type testRowEventSuite struct {
}

var _ = Suite(&testRowEventSuite{})

func (t *testRowEventSuite) SetUpSuite(c *C) {

}

func (t *testRowEventSuite) TearDownSuite(c *C) {
}

func (t *testRowEventSuite) SetUpTest(c *C) {
}

func (t *testRowEventSuite) TearDownTest(c *C) {
}

func (t *testRowEventSuite) TestNegativeDecimal(c *C) {
	var err error
	var data []byte
	var header EventHeader

	// Format description event
	format := FormatDescriptionEvent{}
	data = getFormatDescriptionEvent()
	data = data[1:]
	err = header.Decode(data)
	c.Assert(err, IsNil)

	data = data[19:]
	format.Decode(data)

	// Table map event
	table := TableMapEvent{}
	data = getTableEvent()
	data = data[1:]
	err = header.Decode(data)
	c.Assert(err, IsNil)

	data = data[19:]
	if format.EventTypeHeaderLengths[TABLE_MAP_EVENT-1] == 6 {
		table.tableIDSize = 4
	} else {
		table.tableIDSize = 6
	}
	err = table.Decode(data)
	c.Assert(err, IsNil)

	// Write rows event v2
	event := RowsEvent{}
	event.Version = 2
	event.tableIDSize = table.tableIDSize
	event.tables = make(map[uint64]*TableMapEvent)
	event.tables[table.TableID] = &table

	data = getDataEvent()
	data = data[1:]
	err = header.Decode(data)
	c.Assert(err, IsNil)

	data = data[19:]

	// here is possible infinite loop
	err = event.Decode(data)
	c.Assert(err, IsNil)

	expectedResults := []string{
		"298000.00",
		"226000.00",
		"449000.00",
		"269000.00",
		"999000.00",
		"1380000.00",
		"1109000.00",
		"499000.00",
		"470000.00",
		"950000.00",
		"349000.00",
		"14249000.00",
		"199000.00",
		"2338000.00",
		"179800.00",
		"899000.00",
		"879000.00",
		"14249000.00",
		"679000.00",
		"229000.00",
		"15999000.00",
		"475000.00",
		"279000.00",
		"777000.00",
		"438000.00",
		"69000.00",
		"4699000.00",
		"17469000.00",
		"849000.00",
		"3099000.00",
		"259000.00",
		"585000.00",
		"1399000.00",
		"3949000.00",
		"119000.00",
		"1589000.00",
		"269000.00",
		"449000.00",
		"239000.00",
		"159000.00",
		"3649000.00",
		"2.99",
		"879000.00",
		"164000.00",
		"1290000.00",
		"328000.00",
		"150000.00",
		"85000.00",
		"729000.00",
	}
	for i, expectedValue := range expectedResults {
		decimalValue := fmt.Sprintf("%.2f", event.Rows[i][4])
		c.Assert(decimalValue, Equals, expectedValue, Commentf("Error in case %d", i))
	}

	expectedResults = []string{
		"270909.09",
		"205454.55",
		"408181.82",
		"244545.45",
		"908181.82",
		"1254545.45",
		"1008181.82",
		"453636.36",
		"427272.73",
		"863636.36",
		"317272.73",
		"12940000.00",
		"180909.09",
		"2125454.55",
		"158909.09",
		"817272.73",
		"799090.91",
		"12940000.00",
		"617272.73",
		"208181.82",
		"14544545.45",
		"431818.18",
		"253636.37",
		"706363.63",
		"396441.84",
		"62727.28",
		"4271818.18",
		"15880909.09",
		"771818.18",
		"2817272.73",
		"235454.55",
		"531818.19",
		"1271818.18",
		"3590000.00",
		"108181.82",
		"1444545.45",
		"244545.46",
		"408181.82",
		"217272.73",
		"144545.45",
		"3317272.73",
		"-45363.64",
		"799090.91",
		"149090.91",
		"1172727.27",
		"298181.82",
		"136363.64",
		"77272.73",
		"662727.27",
	}
	for i, expectedValue := range expectedResults {
		decimalValue := fmt.Sprintf("%.2f", event.Rows[i][5])
		c.Assert(decimalValue, Equals, expectedValue, Commentf("Error in case %d", i))
	}
}

func getFormatDescriptionEvent() []byte {
	return []byte{
		0, 45, 140, 216, 84, 15, 101, 0, 0, 0, 116, 0, 0, 0, 0, 0, 0, 0, 0, 0, 4, 0, 53, 46, 54, 46, 50, 49, 45, 55, 48, 46, 49, 45, 108, 111, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
		0, 0, 0, 19, 56, 13, 0, 8, 0, 18, 0, 4, 4, 4, 4, 18, 0, 0, 92, 0, 4, 26, 8, 0, 0, 0, 8, 8, 8, 2, 0, 0, 0, 10, 10, 10, 25, 25, 0, 1, 105, 72, 80, 211,
	}
}

func getTableEvent() []byte {
	return []byte{

		// Header
		0, 67, 147, 216, 84, 19, 101, 0, 0, 0, 137, 0, 0, 0, 25, 215, 111, 3, 0, 0,

		// TableID
		171, 5, 0, 0, 0, 0,

		// Flags
		1, 0,

		// Schema Length
		4,

		102, 102, 102, 102, // Schema name

		// Skip
		0,

		// Table length
		3,

		// Table Name
		101, 101, 101,

		0, 27, 3, 3, 7, 15, 246, 246, 3, 246, 246, 3, 246, 246, 3, 15, 15, 246, 246, 3, 15, 15, 15, 15, 15, 15, 15, 15, 7, 38, 3, 0, 10, 2, 10, 2, 10, 2, 10, 2, 10, 2, 10, 2, 74, 1, 74, 1, 10, 2, 10, 2, 44, 1, 75, 0, 44,
		1, 44, 1, 44, 1, 44, 1, 44, 1, 44, 1, 252, 255, 255, 7,

		// crc checksum
		// 61, 132, 191, 62,
	}
}

func getDataEvent() []byte {
	return []byte{
		// Header
		0, 67, 147, 216, 84, 30, 101, 0, 0, 0, 63, 16, 0, 0, 33, 234, 111, 3, 0, 0,

		// Table id
		171, 5, 0, 0, 0, 0,

		// Flags
		1, 0,

		// Data len
		2, 0,

		// Extra data (nil)

		// Column count
		27,

		// Bitmap count
		255, 255, 255, 255,

		// Columns ...
		128, 141, 249, 251, 69, 236, 32, 0, 104, 148, 28, 0, 39, 119, 216, 84, 1, 48, 128, 4, 140, 16, 0, 128, 4, 34, 61, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 50, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 29, 0, 68, 198, 176, 198, 161, 110, 103, 32, 84, 104, 225, 187, 139, 32, 77, 225, 187, 185, 32, 80, 104, 198, 176, 225, 187, 163, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 70, 236, 32, 0, 105, 148, 28, 0, 48, 119, 216, 84, 1, 49, 128, 3, 114, 208, 0, 128, 3, 34, 142, 55, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 11, 0, 104, 97, 32, 118, 97, 110, 32, 118, 97, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 15, 205, 22, 0, 106, 148, 28, 0, 52, 119, 216, 84, 1, 49, 128, 6, 217, 232, 0, 128, 6, 58, 117, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 110, 103, 117, 121, 225, 187, 133, 110, 32, 118, 196, 131, 110, 32, 116, 105, 225, 187, 135, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 11, 223, 30, 0, 107, 148, 28, 0, 53, 119, 216, 84, 1, 48, 128, 4, 26, 200, 0, 128, 3, 187, 65, 45, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 56, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 78, 103, 225, 187, 141, 99, 32, 77, 105, 110, 104, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 74, 199, 31, 0, 108, 148, 28, 0, 57, 119, 216, 84, 1, 48, 128, 15, 62, 88, 0, 128, 13, 219, 149, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 55, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 27, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 84, 104, 225, 187, 139, 32, 84, 104, 97, 110, 104, 32, 84, 114, 195, 186, 99, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 47, 170, 25, 0, 109, 148, 28, 0, 60, 119, 216, 84, 1, 49, 128, 21, 14, 160, 0, 128, 19, 36, 145, 45, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 53, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 19, 0, 78, 71, 85, 89, 69, 78, 32, 84, 72, 73, 32, 84, 72, 65, 73, 32, 78, 89, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 71, 236, 32, 0, 110, 148, 28, 0, 71, 119, 216, 84, 1, 49, 128, 16, 236, 8, 0, 128, 15, 98, 53, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 49, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 19, 0, 196, 144, 105, 110, 104, 32, 84, 114, 117, 110, 103, 32, 72, 105, 225, 186, 191, 117, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 72, 236, 32, 0, 111, 148, 28, 0, 77, 119, 216, 84, 1, 48, 128, 7, 157, 56, 0, 128, 6, 236, 4, 36, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 51, 56, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 20, 0, 84, 114, 225, 186, 167, 110, 32, 72, 225, 186, 163, 105, 32, 196, 144, 196, 131, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 98, 211, 12, 0, 112, 148, 28, 0, 89, 119, 216, 84, 1, 48, 128, 7, 43, 240, 0, 128, 6, 133, 8, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 52, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 18, 0, 84, 114, 225, 186, 167, 110, 32, 77, 105, 110, 104, 32, 75, 104, 97, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 45, 164, 13, 0, 113, 148, 28, 0, 109, 119, 216, 84, 1, 49, 128, 14, 126, 240, 0, 128, 13, 45, 148, 36, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 50, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 84, 104, 225, 187, 139, 32, 72, 117, 225, 186, 191, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 73, 236, 32, 0, 114, 148, 28, 0, 116, 119, 216, 84, 1, 49, 128, 5, 83, 72, 0, 128, 4, 215, 88, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 18, 0, 196, 144, 195, 180, 204, 131, 32, 76, 195, 170, 32, 86, 105, 204, 131, 110, 104, 32, 67, 147, 216, 84, 128, 13, 248, 251, 137, 155, 1, 0, 115, 148, 28, 0, 152, 119, 216, 84, 1, 48, 128, 217, 108, 40, 0, 128, 197, 114, 224, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 55, 54, 56, 53, 56, 57, 2, 0, 102, 105, 128, 219, 182, 24, 0, 128, 199, 188, 208, 0, 1, 0, 0, 0, 19, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 76, 195, 170, 32, 84, 117, 195, 162, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 75, 236, 32, 0, 116, 148, 28, 0, 155, 119, 216, 84, 1, 49, 128, 3, 9, 88, 0, 128, 2, 194, 173, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 56, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 20, 0, 80, 104, 97, 110, 32, 86, 117, 111, 110, 103, 32, 72, 97, 111, 32, 75, 105, 101, 116, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 56, 105, 19, 0, 117, 148, 28, 0, 156, 119, 216, 84, 1, 48, 128, 35, 172, 208, 0, 128, 32, 110, 142, 55, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 55, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 12, 0, 104, 97, 32, 118, 97, 110, 32, 110, 103, 111, 99, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 252, 223, 32, 0, 118, 148, 28, 0, 165, 119, 216, 84, 1, 48, 128, 2, 190, 88, 0, 128, 2, 108, 189, 9, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 53, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 19, 0, 112, 104, 225, 186, 161, 109, 32, 109, 105, 110, 104, 32, 116, 105, 225, 186, 191, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 166, 192, 32, 0, 119, 148, 28, 0, 178, 119, 216, 84, 1, 48, 128, 13, 183, 184, 0, 128, 12, 120, 120, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 49, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 14, 0, 110, 103, 117, 121, 101, 110, 118, 97, 110, 100, 111, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 47, 226, 16, 0, 120, 148, 28, 0, 189, 119, 216, 84, 1, 48, 128, 13, 105, 152, 0, 128, 12, 49, 114, 91, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 51, 55, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 17, 0, 80, 104, 225, 186, 161, 109, 32, 67, 195, 180, 110, 103, 32, 72, 111, 97, 32, 67, 147, 216, 84, 128, 13, 248, 251, 137, 155, 1, 0, 121, 148, 28, 0, 189, 119, 216, 84, 1, 48, 128, 217, 108, 40, 0, 128, 197, 114, 224, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 52, 53, 54, 56, 53, 56, 57, 2, 0, 102, 105, 128, 219, 182, 24, 0, 128, 199, 188, 208, 0, 1, 0, 0, 0, 19, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 76, 195, 170, 32, 84, 117, 195, 162, 110, 32, 67, 147, 216, 84, 128, 129, 249, 251, 194, 235, 32, 0, 122, 148, 28, 0, 204, 119, 216, 84, 1, 49, 128, 10, 92, 88, 0, 128, 9, 107, 56, 73, 1, 0, 0, 0, 0, 0, 0, 0, 128, 10, 92, 88, 0, 128, 9, 107, 56, 73, 1, 0, 0, 0, 9, 0, 51, 48, 50, 53, 54, 56, 53, 56, 57, 2, 0, 102, 99, 0, 0, 0, 0, 31, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 84, 104, 225, 187, 139, 32, 89, 225, 186, 191, 110, 32, 80, 104, 198, 176, 225, 187, 163, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 145, 181, 15, 0, 123, 148, 28, 0, 207, 119, 216, 84, 1, 49, 128, 3, 126, 136, 0, 128, 3, 45, 53, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 13, 0, 118, 117, 32, 104, 111, 110, 103, 32, 110, 104, 97, 116, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 78, 236, 32, 0, 124, 148, 28, 0, 212, 119, 216, 84, 1, 48, 128, 244, 32, 24, 0, 128, 221, 238, 161, 45, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 15, 0, 76, 195, 170, 32, 65, 110, 32, 84, 104, 225, 186, 161, 99, 104, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 45, 164, 13, 0, 125, 148, 28, 0, 213, 119, 216, 84, 1, 49, 128, 7, 63, 120, 0, 128, 6, 150, 202, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 56, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 84, 104, 225, 187, 139, 32, 72, 117, 225, 186, 191, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 154, 195, 16, 0, 126, 148, 28, 0, 216, 119, 216, 84, 1, 48, 128, 4, 65, 216, 0, 128, 3, 222, 196, 37, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 55, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 15, 0, 84, 114, 97, 110, 32, 84, 117, 97, 110, 32, 68, 105, 101, 112, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 103, 27, 17, 0, 127, 148, 28, 0, 227, 119, 216, 84, 1, 49, 128, 11, 219, 40, 0, 128, 10, 199, 59, 63, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 53, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 32, 0, 84, 114, 198, 176, 198, 161, 110, 103, 32, 84, 114, 225, 186, 167, 110, 32, 80, 104, 198, 176, 198, 161, 110, 103, 32, 84, 104, 225, 186, 163, 111, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 64, 236, 32, 0, 128, 148, 28, 0, 245, 119, 216, 84, 1, 48, 128, 6, 174, 240, 0, 128, 6, 12, 153, 84, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 49, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 9, 0, 69, 114, 105, 99, 32, 66, 117, 105, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 149, 56, 25, 0, 129, 148, 28, 0, 8, 120, 216, 84, 1, 49, 128, 1, 13, 136, 0, 128, 0, 245, 7, 28, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 51, 53, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 14, 0, 68, 97, 110, 104, 32, 67, 97, 32, 76, 105, 195, 170, 109, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 81, 236, 32, 0, 130, 148, 28, 0, 13, 120, 216, 84, 1, 49, 128, 71, 179, 120, 0, 128, 65, 46, 202, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 52, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 110, 103, 117, 121, 225, 187, 133, 110, 32, 104, 225, 187, 169, 117, 32, 98, 195, 172, 110, 104, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 82, 236, 32, 0, 131, 148, 28, 0, 21, 120, 216, 84, 1, 49, 129, 10, 142, 72, 0, 128, 242, 82, 205, 9, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 50, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 15, 0, 112, 104, 97, 109, 32, 116, 104, 105, 32, 116, 117, 121, 101, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 231, 251, 31, 0, 132, 148, 28, 0, 33, 120, 216, 84, 1, 48, 128, 12, 244, 104, 0, 128, 11, 198, 234, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 27, 0, 104, 117, 225, 187, 179, 110, 104, 32, 116, 104, 225, 187, 139, 32, 110, 103, 225, 187, 141, 99, 32, 103, 105, 195, 160, 117, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 228, 186, 30, 0, 133, 148, 28, 0, 34, 120, 216, 84, 1, 48, 128, 47, 73, 120, 0, 128, 42, 252, 248, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 19, 0, 196, 144, 105, 110, 104, 32, 84, 105, 225, 186, 191, 110, 32, 80, 104, 111, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 85, 236, 32, 0, 134, 148, 28, 0, 40, 120, 216, 84, 1, 49, 128, 3, 243, 184, 0, 128, 3, 151, 190, 55, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 56, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 15, 0, 84, 114, 97, 110, 32, 77, 105, 110, 104, 32, 67, 104, 97, 117, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 86, 236, 32, 0, 135, 148, 28, 0, 42, 120, 216, 84, 1, 49, 128, 8, 237, 40, 0, 128, 8, 29, 106, 19, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 55, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 23, 0, 110, 103, 117, 121, 225, 187, 133, 110, 32, 196, 145, 195, 172, 110, 104, 32, 104, 111, 195, 160, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 201, 216, 29, 0, 136, 148, 28, 0, 46, 120, 216, 84, 1, 48, 128, 21, 88, 216, 0, 128, 19, 104, 10, 18, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 53, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 16, 0, 76, 195, 180, 32, 75, 104, 195, 161, 110, 104, 32, 76, 105, 110, 104, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 88, 236, 32, 0, 137, 148, 28, 0, 46, 120, 216, 84, 1, 49, 128, 60, 65, 200, 0, 128, 54, 199, 112, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 49, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 17, 0, 80, 104, 97, 110, 32, 84, 114, 117, 110, 103, 32, 68, 197, 169, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 212, 212, 15, 0, 138, 148, 28, 0, 53, 120, 216, 84, 1, 48, 128, 1, 208, 216, 0, 128, 1, 166, 149, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 51, 49, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 21, 0, 78, 103, 117, 121, 101, 110, 32, 116, 104, 105, 32, 104, 117, 111, 110, 103, 32, 116, 114, 97, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 161, 142, 19, 0, 139, 148, 28, 0, 58, 120, 216, 84, 1, 48, 128, 24, 63, 8, 0, 128, 22, 10, 193, 45, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 52, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 20, 0, 84, 114, 225, 186, 167, 110, 32, 84, 114, 117, 110, 103, 32, 84, 114, 225, 187, 177, 99, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 91, 236, 32, 0, 140, 148, 28, 0, 58, 120, 216, 84, 1, 49, 128, 4, 26, 200, 0, 128, 3, 187, 65, 46, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 50, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 17, 0, 78, 103, 117, 121, 101, 110, 32, 86, 97, 110, 32, 81, 117, 121, 101, 110, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 92, 236, 32, 0, 141, 148, 28, 0, 58, 120, 216, 84, 1, 49, 128, 6, 217, 232, 0, 128, 6, 58, 117, 82, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 20, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 72, 225, 186, 163, 105, 32, 86, 195, 162, 110, 32, 67, 147, 216, 84, 128, 13, 248, 251, 138, 234, 32, 0, 142, 148, 28, 0, 67, 120, 216, 84, 1, 48, 128, 3, 165, 152, 0, 128, 3, 80, 184, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 51, 54, 56, 53, 56, 57, 2, 0, 102, 105, 128, 3, 48, 104, 0, 128, 2, 230, 48, 0, 1, 0, 0, 0, 25, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 88, 117, 195, 162, 110, 32, 84, 114, 198, 176, 225, 187, 157, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 135, 35, 8, 0, 143, 148, 28, 0, 84, 120, 216, 84, 1, 48, 128, 2, 109, 24, 0, 128, 2, 52, 161, 45, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 56, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 16, 0, 77, 195, 163, 32, 86, 196, 131, 110, 32, 84, 104, 195, 160, 110, 104, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 44, 10, 30, 0, 144, 148, 28, 0, 85, 120, 216, 84, 1, 49, 128, 55, 173, 232, 0, 128, 50, 158, 24, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 55, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 25, 0, 110, 103, 117, 121, 225, 187, 133, 110, 32, 116, 114, 105, 225, 187, 129, 117, 32, 100, 198, 176, 198, 161, 110, 103, 32, 67, 147, 216, 84,

		// Wrong row
		128, 141, 249, 251, 31, 161, 7, 0, 145, 148, 28, 0, 89, 120, 216, 84, 1, 48, 128, 0, 0, 2, 99,
		127, 255, 78, 204, 191, // Decimal value -45363.64

		1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 53, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 18, 0, 76, 195, 170, 32, 86, 196, 131, 110, 32, 67, 198, 176, 225, 187, 157, 110, 103, 32, 67, 147, 216, 84,
		// End Wrong row

		128, 141, 249, 251, 135, 173, 31, 0, 146, 148, 28, 0, 100, 120, 216, 84, 1, 49, 128, 13, 105, 152, 0, 128, 12, 49, 114, 91, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 49, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 22, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 116, 104, 225, 187, 139, 32, 104, 225, 187, 147, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 29, 19, 1, 0, 147, 148, 28, 0, 107, 120, 216, 84, 1, 48, 128, 2, 128, 160, 0, 128, 2, 70, 98, 91, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 51, 51, 54, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 20, 0, 68, 198, 176, 198, 161, 110, 103, 32, 84, 225, 187, 173, 32, 75, 105, 225, 187, 135, 116, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 87, 236, 32, 0, 148, 148, 28, 0, 108, 120, 216, 84, 1, 48, 128, 19, 175, 16, 0, 128, 17, 228, 247, 27, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 52, 52, 57, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 17, 0, 76, 195, 162, 109, 32, 77, 105, 110, 104, 32, 84, 104, 195, 180, 110, 103, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 43, 46, 29, 0, 149, 148, 28, 0, 110, 120, 216, 84, 1, 49, 128, 5, 1, 64, 0, 128, 4, 140, 197, 82, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 50, 52, 57, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 22, 0, 78, 103, 117, 121, 225, 187, 133, 110, 32, 72, 225, 187, 147, 110, 103, 32, 72, 225, 186, 163, 105, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 96, 236, 32, 0, 150, 148, 28, 0, 115, 120, 216, 84, 1, 49, 128, 2, 73, 240, 0, 128, 2, 20, 171, 64, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 54, 52, 57, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 17, 0, 196, 144, 195, 160, 111, 32, 78, 103, 225, 187, 141, 99, 32, 72, 117, 121, 32, 67, 147, 216, 84,
		128, 141, 249, 251, 80, 236, 32, 0, 151, 148, 28, 0, 129, 120, 216, 84, 1, 48, 128, 1, 76, 8, 0, 128, 1, 45, 216, 73, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 9, 0, 51, 48, 57, 52, 57, 56, 53, 56, 57, 1, 0, 45, 0, 0, 0, 0, 18, 0, 68, 198, 176, 198, 161, 110, 103, 32, 72, 111, 195, 160, 105, 32, 78, 97, 109, 32, 67, 147, 216, 84,

		// Sample row
		128, 141, 249, 251, // bitmap
		97, 236, 32, 0, // int(11)
		152, 148, 28, 0, // int(11)
		131, 120, 216, 84, // timestamp
		1, 49, // varchar(1)
		128, 11, 31, 168, 0, // decimal(10,2)
		128, 10, 28, 199, 27, // decimal(10,2)
		1, 0, 0, 0, // int(11)
		// 7. NIL
		// 8. NIL
		0, 0, 0, 0, // int(11)
		// 10. NIL
		// 11. NIL
		0, 0, 0, 0, // int(11)
		9, 0, 51, 48, 56, 52, 57, 56, 53, 56, 57, // varchar(9)
		1, 0, 45, //  varchar(1)
		// 15. NIL
		// 16. NIL
		0, 0, 0, 0, // int(11)
		16, 0, 78, 103, 117, 121, 101, 110, 32, 99, 111, 110, 103, 32, 72, 111, 97, 32, // name / varchar(16)
		67, 147, 216, 84, // timestamp

		// 220, 248, 239, 245, // checksum
	}
}
